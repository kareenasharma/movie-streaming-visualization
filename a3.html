<html>
<!DOCTYPE html>
<meta charset="utf-8">
<style>
  
</style>

<body>
  <!-- d3 v6 integration -->
  <script src="https://d3js.org/d3.v6.min.js"></script>
  
  <script>
    let width = 960,
      height = 500;

    // let projection = d3.geoAlbersUsa();
    // let path = d3.geoPath()
    //   .projection(projection);

    let svg = d3.select("body").append("svg")
      .attr("width", width)
      .attr("height", height);

    // var tooltip = d3.select("body").append("div")
    //   .attr("class", "tooltip")
    //   .style("opacity", 0);

    // call the function that draws
    ready();

    // keep these around for later
    let us, states, centroid;

    async function ready() {
      // load files async; store the values so we can use them later
      let data = await d3.csv("MoviesOnStreamingPlatforms_updated.csv");
      //let genres = (data[].Genres.split(","))[0];

      // creating genre dictionary
      var genres = {};

      // creating genre set and adding distinct genres
      const genre_list = new Set();
      for (i = 0; i < 16743; i++) {
        let temp = data[i].Genres.split(",")
        for (j = 0; j < temp.length; j++) {
          genre_list.add(temp[j]);
        }
      }

      // set genres as keys
      for (let i of genre_list) {
        genres[i] = [];
      }

      // adding relevant data to the genres dictionary
      for (i = 0; i < data.length; i++) {
        let temp = data[i].Genres.split(",")[0];
        genres[temp].push(data[i]);
      }



      console.log(genres);
      console.log(genre_list);

      let genre_array = Array.from(genre_list);

      function col(d) {
        let index = genre_array.indexOf(d.Genres.split(",")[0]);
        let scale = d3.scaleLinear().domain([0,27]).range([0,1]);
        return d3.interpolateTurbo(scale(index));

      }

      var circle = svg.selectAll("circle")
      .data(data)
      .enter()
      .append("circle")
        .attr("cx", function(d) { return Math.random() * 960;  })
        .attr("cy",function(d) { return Math.random() * 500; })
        .attr("r", 3)
        .style("stroke", "black")
        .style("fill", function(d) { return col(d);})
        .style("opacity", 0.5)
        .on("mouseover", function(d,i){ d3.select(this).attr("r", 50); })
        .on("mouseout", function(d,i){ d3.select(this).attr("r", 10); });

      //varcircle = svg.selectAll("circle").data(data).enter().append("circle").attr("cx", function(d) { return x(d.price);  }).attr("cy",function(d) { return y(d.tValue); })


      // console.log(genres)
      // console.log(data)

      // draw the states
      // svg.append("path")
      //   .attr("class", "states")
      //   .datum(topojson.feature(states, states.objects.usStates))
      //   .attr("d", path);

      // draw the symbols on top
    //   svg.selectAll(".symbol")
    //     .data(centroid.features.sort(function (a, b) { return b.properties.population - a.properties.population; }))
    //     .enter().append("path")
    //     .attr("class", "symbol")
    //     .attr("fill", "green")
    //     .attr("d", path.pointRadius(function (d) { return 10 }))
    //     .on("mouseover", function(d) {
    //         d3.select(this).attr("fill", "red");
    //         tooltip.transition()
    //           .duration(200)
    //           .style("opacity", .9);
    //         tooltip.html("State: " + d.properties.name + ', ' + d.properties.population)
    //           .style("left", (d3.event.pageX) + "px")
    //           .style("top", (d3.event.pageY -28) + "px");
    //     })
    //     .on("mouseout", function(d) {
    //         d3.select(this).attr("fill", "green");
    //         tooltip.transition()
    //           .duration(200)
    //           .style("opacity", 0);
    //     });
    }

    // function recolor(color) {
    //   // grab the symbol objects and modify their color 
    //   // notice we don't need "enter" or "append" the objects are already there
    //   svg.selectAll(".symbol")
    //     .attr("fill", color);
    // }


  </script>

  <!-- <FORM> -->
    <!-- <INPUT TYPE="Button" value="reset" onclick="recolor('green')"/> 
    <INPUT TYPE="Button" value="map to color" onclick="recolor('blue')"/> 
    <INPUT TYPE="Button" value="map to size" onclick="recolor('blue')"/> 
    <INPUT TYPE="Button" value="map to both" onclick="recolor('blue')"/>  -->
  <!-- </FORM> -->
  
</body>
</html>